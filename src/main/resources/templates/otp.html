<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Otp</title>

<!-- Inline CSS (everything self-contained) -->
<style>
  :root{
    --bg:#0f1724;
    --card:#0f172433; /* translucent */
    --glass: rgba(255,255,255,0.06);
    --muted: #98a0b3;
    --accent1: #6ee7b7;
    --accent2: #60a5fa;
    --danger: #ff6b6b;
    --success: #34d399;
    --glass-border: rgba(255,255,255,0.08);
    --radius: 14px;
    --shadow: 0 8px 30px rgba(2,6,23,0.6);
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }

  /* Page */
  html,body{
    height:100%;
    margin:0;
    background:
      radial-gradient(1200px 600px at 10% 10%, rgba(96,165,250,0.06), transparent 10%),
      radial-gradient(800px 400px at 90% 90%, rgba(110,231,183,0.04), transparent 10%),
      var(--bg);
    color:#e6eef8;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* Layout wrapper */
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:2rem;
    padding:3rem 1.25rem;
  }

  /* Card */
  .card {
    width:100%;
    max-width:420px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:var(--radius);
    box-shadow: var(--shadow);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(8px) saturate(120%);
    padding:2rem;
    position:relative;
    overflow:hidden;
  }

  .brand {
    display:flex;
    align-items:center;
    gap:0.75rem;
    margin-bottom:1rem;
  }
  .logo {
    width:44px;
    height:44px;
    border-radius:10px;
    background: linear-gradient(135deg, var(--accent1), var(--accent2));
    display:inline-grid;
    place-items:center;
    font-weight:700;
    color:#082032;
    box-shadow: 0 6px 18px rgba(96,165,250,0.12), inset 0 -6px 12px rgba(255,255,255,0.02);
  }
  .brand h1{
    font-size:1.1rem;
    margin:0;
    letter-spacing: -0.2px;
  }
  .brand p{ margin:0; font-size:0.8rem; color:var(--muted); }

  h2 {
    margin:0 0 1rem 0;
    font-size:1.35rem;
    letter-spacing:-0.5px;
  }
  p.lead { margin:0 0 1.25rem 0; color:var(--muted); font-size:0.95rem; }

  /* Form */
  form { display:flex; flex-direction:column; gap:1rem; }
  .input {
    display:flex;
    flex-direction:column;
    gap:0.4rem;
  }
  label{
    font-size:0.78rem;
    color:var(--muted);
  }
  input[type="number"], input[type="text"], input[type="email"] {
    appearance: none;
    -webkit-appearance: none;
    border:1px solid rgba(255,255,255,0.06);
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    color: #eaf2ff;
    padding:0.9rem 1rem;
    border-radius:10px;
    font-size:1rem;
    outline:none;
    transition: box-shadow .18s ease, transform .08s ease, border-color .12s ease;
    box-shadow: inset 0 -6px 12px rgba(0,0,0,0.18);
  }
  input::placeholder { color: #9bb0d0; opacity:0.9; }
  input:focus {
    border-color: rgba(96,165,250,0.9);
    box-shadow: 0 6px 20px rgba(96,165,250,0.08), inset 0 -6px 12px rgba(0,0,0,0.18);
    transform: translateY(-1px);
  }

  /* Big OTP input style when numeric - center the digits look */
  .otp-row{
    display:flex;
    gap:0.6rem;
    justify-content:center;
  }

  .btn {
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:0.6rem;
    padding:0.9rem 1.05rem;
    border-radius:12px;
    border:0;
    font-weight:600;
    cursor:pointer;
    transition: transform .08s ease, box-shadow .12s ease;
    background: linear-gradient(90deg, var(--accent1), var(--accent2));
    color:#042028;
    box-shadow: 0 10px 30px rgba(96,165,250,0.12);
  }
  .btn:active { transform: translateY(1px) scale(.997); }
  .btn.secondary {
    background:transparent;
    border:1px solid rgba(255,255,255,0.06);
    color:var(--muted);
    box-shadow:none;
  }

  .help {
    display:flex;
    justify-content:space-between;
    align-items:center;
    font-size:0.85rem;
    color:var(--muted);
    margin-top:0.25rem;
  }

  /* Toasts container (top-right) */
  .toast-container {
    position: fixed;
    top: 1rem;
    right: 1rem;
    width: min(380px, calc(100% - 2rem));
    z-index:1200;
    display:flex;
    flex-direction:column;
    gap:0.75rem;
    pointer-events:none; /* allow clicks through container except on toasts */
  }

  .toast {
    pointer-events:auto;
    border-radius:12px;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    transform-origin: top right;
    animation: toast-in .35s cubic-bezier(.2,.9,.2,1);
    border:1px solid rgba(255,255,255,0.04);
    box-shadow: 0 12px 34px rgba(2,6,23,0.6);
  }
  @keyframes toast-in{
    from{ opacity:0; transform: translateY(-12px) scale(.98); }
    to{ opacity:1; transform: translateY(0) scale(1); }
  }

  .toast-header {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:0.5rem;
    padding:0.55rem 0.75rem;
    font-weight:700;
  }
  .toast-body {
    padding:0.75rem;
    font-size:0.95rem;
    color:#eaf2ff;
  }

  .toast.success { background: linear-gradient(90deg, rgba(52,211,153,0.12), rgba(110,231,183,0.06)); border-left:4px solid var(--success); }
  .toast.error { background: linear-gradient(90deg, rgba(255,107,107,0.08), rgba(255,107,107,0.03)); border-left:4px solid var(--danger); }
  .toast .close-btn {
    background:transparent;
    border:0;
    color:inherit;
    cursor:pointer;
    font-weight:700;
    font-size:0.95rem;
    opacity:0.9;
  }

  /* small screens */
  @media (max-width:480px){
    .card{ padding:1.25rem; border-radius:12px; }
    .brand h1{ font-size:1rem; }
    h2{ font-size:1.1rem; }
    .toast-container { right:0.5rem; left:0.5rem; width:auto; }
  }
</style>
</head>
<body>

<div class="wrap">

  <main class="card" role="main" aria-labelledby="otp-heading">
    <div class="brand">
      <div class="logo">BM</div>
      <div>
        <h1>BookMyTicket</h1>
        <p>Secure OTP verification</p>
      </div>
    </div>

    <h2 id="otp-heading">Enter OTP</h2>
    <p class="lead">We've sent a one-time password to your email. Enter the 6-digit OTP below to continue.</p>

    <!-- Toasts: server-side flags will render these blocks. Keep structure but server injects content.
         We'll also include a small JS to auto-hide them for better UX. -->
    <div aria-live="polite" aria-atomic="true" class="toast-container" id="toastContainer">
      <!-- Example elements rendered by server (Thymeleaf) -->
      <!--
      <div class="toast success" id="serverPass">
        <div class="toast-header">
          <span>Success</span>
          <button class="close-btn" onclick="dismissToast(this)">✕</button>
        </div>
        <div class="toast-body">Otp Sent Success</div>
      </div>
      -->
      <!--
      <div class="toast error" id="serverFail">
        <div class="toast-header">
          <span>Error</span>
          <button class="close-btn" onclick="dismissToast(this)">✕</button>
        </div>
        <div class="toast-body">Invalid OTP Try Again</div>
      </div>
      -->
    </div>

    <!-- OTP form -->
    <form action="/otp" method="post" novalidate>
      <!-- keep hidden email for server -->
      <input type="hidden" name="email" th:value="${email}">

      <div class="input">
        <label for="otpInput">One-time password</label>
        <input id="otpInput" name="otp" type="number" inputmode="numeric" placeholder="Enter 6-digit OTP" min="0" maxlength="6" required />
      </div>

      <div class="help">
        <small>Didn't receive? <a href="/resend" style="color:var(--accent2); text-decoration:none; font-weight:600;">Resend OTP</a></small>
        <small style="color:var(--muted)">Valid for 5 minutes</small>
      </div>

      <div style="display:flex; gap:0.6rem; margin-top:0.75rem;">
        <button type="submit" class="btn" aria-label="Submit OTP">Verify OTP</button>
        <a href="/register" class="btn secondary" style="text-decoration:none; display:inline-flex; align-items:center; justify-content:center;">Back</a>
      </div>
    </form>

  </main>

</div>

<!-- Inline JS to auto-show server-rendered toasts and auto-dismiss them -->
<script>
  // Helper to create a toast node (used if server flags are present).
  function createToast(kind, title, message) {
    const toast = document.createElement('div');
    toast.className = 'toast ' + (kind === 'success' ? 'success' : 'error');
    toast.setAttribute('role','status');

    const hdr = document.createElement('div');
    hdr.className = 'toast-header';
    const titleEl = document.createElement('span');
    titleEl.textContent = title;
    const btn = document.createElement('button');
    btn.className = 'close-btn';
    btn.setAttribute('aria-label','Close');
    btn.innerHTML = '✕';
    btn.onclick = () => dismissToast(btn);

    hdr.appendChild(titleEl);
    hdr.appendChild(btn);

    const body = document.createElement('div');
    body.className = 'toast-body';
    body.textContent = message;

    toast.appendChild(hdr);
    toast.appendChild(body);
    return toast;
  }

  function dismissToast(el){
    const toast = el.closest('.toast');
    if(!toast) return;
    toast.style.transition = 'transform .25s ease, opacity .25s ease';
    toast.style.opacity = '0';
    toast.style.transform = 'translateY(-8px) scale(.98)';
    setTimeout(()=> toast.remove(), 260);
  }

  // Auto-detect Thymeleaf-injected flags and render toasts client-side.
  (function autoRenderServerToasts(){
    // Thymeleaf will have server-provided fragments — we support both server-rendered
    // DOM or just server variables. Below are two approaches; uncomment what's used.

    const container = document.getElementById('toastContainer');

    // Approach 1) If server renders elements with th:if (already in DOM), animate auto hide:
    Array.from(container.querySelectorAll('.toast')).forEach(t => {
      setTimeout(()=> dismissToast(t.querySelector('.close-btn')), 3500);
    });

    // Approach 2) If server sets variables (like pass/fail text), you can
    // create toasts here. Example with Thymeleaf:
    // th:if="${pass}" -> server will render a script tag setting window.SRV_PASS = '...';
    if (window.SRV_PASS) {
      const t = createToast('success','Success', window.SRV_PASS);
      container.appendChild(t);
      setTimeout(()=> dismissToast(t.querySelector('.close-btn')), 3500);
    }
    if (window.SRV_FAIL) {
      const t = createToast('error','Error', window.SRV_FAIL);
      container.appendChild(t);
      setTimeout(()=> dismissToast(t.querySelector('.close-btn')), 4500);
    }
  })();
</script>

</body>
</html>
